<link rel="import" href="../../web_lib/grapp-core-ajax/grapp-core-ajax.html">
<link rel="import" href="../../web_lib/grapp-rest-resource/grapp-rest-resource.html">
<link rel="import" href="../../web_lib/grapp-breadcrumbs/grapp-breadcrumbs.html">
<link rel="import" href="../caretaker-i18n/caretaker-i18n.html">
<link rel="import" href="../caretaker-data-editor/caretaker-data-editor.html">

<polymer-element name="caretaker-rooms-editor" attributes="token">

  <template>

    <grapp-rest-resource url="/buildings/:buildingId/floors/:floorId/rooms/:id"
                         params='{{ {"buildingId":buildingId, "floorId":floorId} }}'
                         resource="{{rooms}}" token="{{token}}"></grapp-rest-resource>

    <grapp-core-ajax id="buildingName" url="/buildings/{{buildingId}}/name" handleAs="json" response="{{building}}"
               token="{{token}}" auto>
    </grapp-core-ajax>

    <grapp-core-ajax id="floorName" url="/buildings/{{buildingId}}/floors/{{floorId}}/name" handleAs="json" response="{{floor}}"
               token="{{token}}" auto>

    </grapp-core-ajax>

    <grapp-app-globals>
      <grapp-app-global-value name="appTitle" value="models.room.other"></grapp-app-global-value>
      <grapp-app-global-value name="appModule" value="manage"></grapp-app-global-value>
      <grapp-app-global-value name="appFunction" value="rooms"></grapp-app-global-value>
    </grapp-app-globals>

    <grapp-breadcrumbs>
      <grapp-breadcrumb href="/#/buildings">{{'models.building.other'|i18n}}</grapp-breadcrumb>
      <grapp-breadcrumb href="/#/buildings/{{buildingId}}">{{building.name}}</grapp-breadcrumb>
      <grapp-breadcrumb href="/#/buildings/{{buildingId}}/floors">{{'models.floor.other'|i18n}}</grapp-breadcrumb>
      <grapp-breadcrumb href="/#/buildings/{{buildingId}}/floors/{{id}}">{{floor.name}}</grapp-breadcrumb>
      <grapp-breadcrumb href="/#/buildings/{{buildingId}}/floors/{{id}}/rooms">{{'models.room.other'|i18n}}
      </grapp-breadcrumb>
      <grapp-breadcrumb>{{$.editor.item.number}}</grapp-breadcrumb>
    </grapp-breadcrumbs>

    <caretaker-data-editor id="editor" model="room" resource="{{rooms}}" on-data-editor-back="{{back}}">

      <caretaker-data-field name="number"></caretaker-data-field>
      <caretaker-data-field name="description"></caretaker-data-field>

    </caretaker-data-editor>

  </template>

  <script src="caretaker-rooms-editor.js"></script>

</polymer-element>
