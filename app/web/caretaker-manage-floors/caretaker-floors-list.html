<link rel="import" href="../../web_lib/grapp-app-globals/grapp-app-globals.html">
<link rel="import" href="../../web_lib/grapp-core-ajax/grapp-core-ajax.html">
<link rel="import" href="../../web_lib/grapp-rest-resource/grapp-rest-resource.html">
<link rel="import" href="../../web_lib/grapp-breadcrumbs/grapp-breadcrumbs.html">
<link rel="import" href="../caretaker-i18n/caretaker-i18n.html">
<link rel="import" href="../caretaker-data-table/caretaker-data-table.html">
<link rel="import" href="../caretaker-select/caretaker-select.html">

<polymer-element name="caretaker-floors-list" attributes="token">

  <template>

    <grapp-app-globals id="globals">
      <grapp-app-global-value name="appTitle" value="models.floor.other"></grapp-app-global-value>
      <grapp-app-global-value name="appModule" value="manage"></grapp-app-global-value>
      <grapp-app-global-value name="appFunction" value="floors"></grapp-app-global-value>
    </grapp-app-globals>

    <grapp-rest-resource url="{{$.globals.apiURL}}/buildings/:buildingId/floors/:id?q={{searchText}}"
                         params='{{ {"buildingId":buildingId} }}'
                         resource="{{floors}}" token="{{token}}">
    </grapp-rest-resource>

    <grapp-core-ajax id="buildingsNames" url="{{$.globals.apiURL}}/buildings/names" handleAs="json"
                     response="{{buildingsNames}}"
                     token="{{token}}" auto>
    </grapp-core-ajax>

    <grapp-breadcrumbs>
      <grapp-breadcrumb href="/#/buildings">{{'models.building.other'|i18n}}</grapp-breadcrumb>
      <grapp-breadcrumb href="/#/buildings/{{buildingId}}">{{buildingsNames | nameOfBuilding(buildingId)}}
      </grapp-breadcrumb>
      <grapp-breadcrumb>{{'models.floor.other'|i18n}}</grapp-breadcrumb>
    </grapp-breadcrumbs>

    <caretaker-data-table id="table" model="floor" resource="{{floors}}" searchText="{{searchText}}"
                          on-data-table-edit="{{edit}}" on-data-table-new="{{new}}">

      <caretaker-data-column name="name" width="30"></caretaker-data-column>
      <caretaker-data-column name="description" width="70"></caretaker-data-column>

      <caretaker-data-action icon="columns" on-fire="{{showRooms}}"></caretaker-data-action>

      <caretaker-toolbar-extension>
        <caretaker-select items="{{buildingsNames}}" selectedId="{{buildingId}}"
                          placeholder="{{'models.building.one'|i18n}}..."></caretaker-select>
      </caretaker-toolbar-extension>

    </caretaker-data-table>

  </template>

  <script src="caretaker-floors-list.js"></script>

</polymer-element>
